# 집합연산자

### 집합 연산자란?

- 두개 이상의 테이블에서 조인을 사용하지 않고 연관된 데이터를 조회하는 방법중 하나
- 테이블에서 SELECT한 컬럼의 수와 각 컬럼의 데이터타입이 테이블 간 상호 호환 가능해야 함

#### UNION

- 두 개의 테이블을 하나로 만드는 연산
- UNION에 사용할 커럼의 수와 데이터 형식이 일치해야 하며 합친 후에 테이블에서 중복된 데이터는 제거
- 합집합의 역할

```SQL
SELECT * FROM A_T
UNION
SELECT * FROM B_T;
```

#### UNION ALL

- UNION과 거의 같은 기능을 수행
- 단, UNION과 달리 중복 제거와 정렬을 하지 않음

#### INTERSECT

- 두 개의 테이블에 대해 겹치는 부분을 추출하는 연산
- 추출 후에는 중복된 결과를 제거
- 교집합의 역할

```SQL
SELECT A, B FROM A_T
INTERSECT
SELECT A, B FROM B_T;
```

#### EXCEPT(MINUS)

- 두 개의 테이블에서 겹치는 부분을 앞의 테이블에서 제외하여 추출하는 연산
- 추출 후에는 중복된 결과를 제거
- 차집합의 역할

```SQL
SELECT A, B FROM A_T
EXCEPT
SELECT A, B FROM B_T;
```

### 계층형 질의

- 테이블에 계층형 데이터가 존재하는 경우
- 데이터를 조회하기 위해 사용하는 것

### 서브쿼리 분류

- 서브쿼리에 메인쿼리의 컬럼이 포함되는지에 따라 구분

#### 연관서브쿼리

- 메인쿼리의 컬럼이 서브쿼리에 포함되며, 메인쿼리의 컬럼은 서브쿼리에 특정 조건으로 사용됨

#### 비연관서브쿼리

- 메인쿼리 컬럼이 서브쿼리에 포함되지 않으며, 주로 메인 쿼리에 특정한 값을 제공할 때 사용됨

#### 단인 행 서브쿼리

- 서브쿼리의 결과가 한 개의 행을 반환하며 단일행 비교 연산자와 같이 사용됨

#### 다중 행 서브쿼리

- 서브쿼리의 결과가 두 개 이상 행을 반환할 수 있으며, 다중 행 비교 연산자와 같이 사용됨

#### 다중 컬럼 서브쿼리

- 서브쿼리의 결과가 여러 개의 컬럼을 반환하며 메인쿼리의 조건과 동시에 비교됨

---

### 뷰

- 다른 테이블에서 파생된 테이블
- 물리적으로 데이터가 저장되는 것이 아니라 논리적으로만 존재하며 뷰를 사용한 질의 시에는 dbms에서 뷰 정의에 따라 질의를 재작성하여 수행함

#### 뷰의 장점

- 독립성 : 테이블 구조가 변경되어도 뷰를 사용하고 있는 응용 프로그램은 변경하지 않아도됨
- 편리성 : 자주 사용되는 복잡한 쿼리를 미리 뷰로 정의해 놓으면 추후 쿼리는 간단한 형태로 표현할 수 있음
- 보안성 : 사용자의 권한에 따라 열람 가능한 데이터를 다르게할 수 있음. 권한에 따라 확인 가능한 컬럼을 정의하여 뷰를 생성하면 기본 테이블 노출 없이 접근 제어를 할 수 있음

#### 뷰의 특징

- 생성된 뷰를 또 다른 뷰를 생성하는데 사용될 수 있음
- 뷰의 정의는 변경할 수 없으며 삭제 후 재생성이 필요함
- 뷰를 통한 갱신에는 제약이 따름
  - 갱신을 위해서는 기본적으로 원천 테이블의 기본키가 포함되어야 함
- 원천이 되는 테이블이나 뷰가 삭제되면 이를 기반으로 하는 뷰도 함게 삭제됨

```SQL
CREAT [OR REPLACE] VIEW V_A AS
SELECT AC1, AC2, ...
FROM T_A
WHERE 조건
```

참고 : 엘리스
