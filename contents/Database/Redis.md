# Redis

### Redis란?

- Redis : Remote Dictionary Server
- key-value 구조의 비정형 데이터를 저장하고 관리하기 위한 오픈소스 기반의 NoSQL DBMS
- 사용에 따라 데이터베이스로 사용될 수도 있고 Cache Server로 사용될 수도 있음
- 오픈 소스 기반으로 인메모리 데이터 구조 저장소로 메모리에 데이터를 저장함
  - 휘발성
- 별도의 쿼리문이 필요로 하지 않고 인메모리에 저장되기 때문에 상당히 빠른 속도로 처리 할 수 있음

#### +)캐싱

- 실제 원본에 가지 않아도 빠르게 접근할 수 있도록 임시적으로 저장해놓음
- 미리 계산된 데이터나 자주 사용되는 데이터를 임시적으로 저장함으로써 데이터에 빠르게 접근 할 수 있도록 함

### Redis 사용 이유

- DB는 데이터를 물리 디스크에 직접 쓰기 때문에 서버에 문제가 발생하여 다운되더라도 데이터가 손실되지 않음
  - 하지만 매번 디스크에 접근하기 때문에 사용자가 많아질수록 부하 증가
- 이때 Cache server를 도입하여 사용하고 cache server로 redis를 이용할 수 있음
- Cache Server 사용 시 같은 요청에 매번 데이터베이스를 거치는 것이 아닌 cache server에서 첫 번째 요청 이후 저장된 결과값을 바로 반환
- 데이터베이스 부하 감소 가능! 서비스 속도 향상!

### Redis의 특징과 장점

- Key, Value 구조이기 때문에 쿼리를 사용할 필요가 없음
  - 고정 되지 않은 스키마를 가지므로 키마다 원하는 내용만 저장 가능
- In-Memory 데이터베이스
  - 매우 빠름
  - 서버 재시작 시 모든 데이터 유실
  - 복제 기능있지만 사람의 실수에는 복원 불가
  - 백업이 필요할 수 있음 (persist option 지원)
- 다양한 자료구조를 제공
  - string, list, hash, set, sorted, set, stream 등
  - 사용 용이, 개발 편의성 증대
  - application 단에서 필요한 로직을 DB 단에서 줄일 수 있음
  - list형 데이터 입력/삭제가 MySQL에 비해 10배 빠름
- Single Thread로 동작
  - 한 번에 여러 클라이언트의 요청을 수행할 수 없음
  - 한 클라이언트가 오래 걸리는 작업을 요청하면 장애가 발생할 수 있음
- 여러 대의 서버 구성 가능

#### 성능

- 모든 Redis 데이터는 메모리에 저장되어 대기 시간을 낮추고 처리량을 높임
- 평균적으로 읽기 및 쓰기의 작업 속도가 1ms로 디스크 기반 데이터베이스보다 빠름

#### 유연한 데이터 구조

- Redis의 데이터는 String, List, Set, Hash, Sorted Set, Bitmap, Json 등 다양한 데이터 타입 지원
- 애플리케이션의 요구 사항에 알맞은 다양한 데이터 타입을 활용할 수 있음

#### 개발 용이성

- 쿼리문이 필요로 하지 않으며 단순한 명령 구조로 데이터의 저장, 조회 등이 가능
- Java, python, c, c++, c#, JS, PHP, Node.js, Ruby 등 다수의 언어를 지원

#### 영속성(persistence - 지속성)

- 영속성 : 데이터를 생성한 프로그램이 종료되어도 사라지지 않는 데이터의 특성을 말함
- Redis는 영속성을 보장하기 위해 데이터를 디스크에 저장할 수 있음
- 서버에 치명적인 문제가 발생하더라도 디스크에 저장된 데이터를 통해 복구가 가능함
- Redis는 메모리 기반의 저장소로 데이터를 저장할 때 휘발성이기 때문에 서버가 종료되거나 재시작되면 데이터가 모두 손실 되지만 영속성이 필요한 경우 별도의 설정을 해주면 됨

#### 싱글 스레드 방식

- 한 번에 하나의 명령어만을 처리함
- 연산을 원자적으로 처리하여 race condition(경쟁 상태)가 거의 발생하지 않음
- 단일 CPU

### Redis의 사용 사례

- 캐싱
- 채팅, 메시징 및 대기열
- 랭킹 보드 (순위표)
- 인증 토큰 저장 (세선 스토어)
- 다양한 미디어 스트리밍
- 실시간 분석
- 위치기반 데이터 타입 사용

### Redis Clustering

- 서버에 장애가 생기는 경우 방지 방법
- 레디스 서버를 몇개를 둬서 한 서버가 터지면 다른 서버를 빌려서 계속 작업을 이어나가는 것

#### 지정된 간격으로 데이터의 스냅샷 찍어 저장

- 서버가 다 터지는 경우 해결책
- 지정된 간격으로 데이터의 스냅샷을 찍어 저장하는 것
- 현재 메모리에 저장된 데이터 상태들을 특정시점에 저장ㅎ나느 것

[참고 포스팅](https://velog.io/@inhwa1025/Redis-Redis%EB%9E%80-Redis%EC%9D%98-%EA%B0%9C%EB%85%90%EA%B3%BC-%ED%8A%B9%EC%A7%95)
[참고 포스팅](https://ittrue.tistory.com/317)
[참고 포스팅](https://upcurvewave.tistory.com/354)
[참고 포스팅](https://velog.io/@cofreeman/JWT-%EC%99%80-Redis-%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%B4-%EC%9E%A5%EB%B0%94%EA%B5%AC%EB%8B%88-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0)
